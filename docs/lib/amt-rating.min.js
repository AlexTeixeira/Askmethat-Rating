"use strict";var AskmethatRatingSteps;!function(t){t[t.DecimalStep=0]="DecimalStep",t[t.HalfStep=1]="HalfStep",t[t.OnePerOneStep=2]="OnePerOneStep"}(AskmethatRatingSteps||(AskmethatRatingSteps={}));var AskmethatRating=function(){function t(t,e,a){var n=this;if(this._defaultOptions={hoverColor:"#ffff66",backgroundColor:"#e5e500",minRating:1,maxRating:5,fontClass:"fa fa-star",readonly:!1,step:AskmethatRatingSteps.DecimalStep},this._parentElement=t,a&&(this._defaultOptions=a),this._defaultOptions.minRating>e)throw new Error("Default value should be higher than minRating options");this._defaultOptions.readonly||this._parentElement.addEventListener("mouseleave",function(t){return n.onMouseLeave(t)}),this.render(e)}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){if(t<this._defaultOptions.minRating)throw Error("New value cannot be less than min rating value");this._value=t,this.render(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!0,configurable:!0}),t.prototype.render=function(t){var e=this;void 0===t&&(t=this._defaultOptions.minRating),this._parentElement.innerHTML="";for(var a=1;a<=this._defaultOptions.maxRating;a++){var n=document.createElement("span"),i=document.createElement("span");if(i.className=this._defaultOptions.fontClass,i.className+=" amt-rating-elem amt-rating-under amt-rating",i.setAttribute("data-rating",a.toString()),i.style.color=this._defaultOptions.backgroundColor,n.className+=this._defaultOptions.fontClass,n.className+=" amt-rating-under am-rating",n.style.color=this._defaultOptions.hoverColor,n.style.width="0%",a<=t)i.classList.contains("amt-active")||(i.className+=" amt-active"),n.style.width="100%",a===t&&(i.className+=" amt-selected");else if(Number(t.toFixed(1))>=a-1&&Number(t.toFixed(1))<a&&t%1!==0){i.className+=" amt-active amt-selected";var s=Number((t%1).toFixed(1));n.style.width=100*s+"%"}else i.style.color=this._defaultOptions.backgroundColor,i.classList.remove("amt-active"),n.style.width="0%";this._value=t,this._defaultOptions.readonly||(i.addEventListener("click",function(t){return e.onRatingClick(t)}),i.addEventListener("mousemove",function(t){return e.onMouseMove(t)})),i.appendChild(n),this._parentElement.appendChild(i)}},t.prototype.onRatingClick=function(t){var e=t.srcElement,a=e.querySelector(".amt-rating-under"),n=Number(e.getAttribute("data-rating")),i=n-1+Number((.01*parseInt(a.style.width,10)).toFixed(1));i<this._defaultOptions.minRating||(0!==this.value&&this._parentElement.querySelector(".amt-selected").classList.remove("amt-selected"),this._value=i,0!=this.value&&(e.className+=" amt-selected"),this._changeEvent=new CustomEvent("amt-change",{detail:this.value}),this._changeEvent.initEvent("amt-change",!1,!0),this._parentElement.dispatchEvent(this._changeEvent))},t.prototype.getValueAccordingToStep=function(t){switch(this.defaultOptions.step){case AskmethatRatingSteps.HalfStep:return Math.round(2*t)/2;case AskmethatRatingSteps.OnePerOneStep:return Math.ceil(t);default:return t}},t.prototype.onMouseMove=function(t){var e=t.srcElement,a=Number(e.getAttribute("data-rating")),n=Number((t.offsetX/t.srcElement.clientWidth*100).toFixed(0)),i=a-1+Number((.01*n).toFixed(1));if(i=this.getValueAccordingToStep(i),!Number(i)||i==Number.POSITIVE_INFINITY&&i==Number.NEGATIVE_INFINITY){if(0==i)return void this.setOrUnsetActive(i);this.setOrUnsetActive(a)}else console.log(i),this.setOrUnsetActive(i)},t.prototype.onMouseLeave=function(t){this.setOrUnsetActive(this.value)},t.prototype.setOrUnsetActive=function(t){for(var e=1;e<=this._defaultOptions.maxRating;e++)if(!(e<this._defaultOptions.minRating)){var a=this._parentElement.querySelector(".amt-rating-elem[data-rating='"+e+"']"),n=a.querySelector(".amt-rating-under");if(e<=t){a.classList.contains("amt-active")||(a.className+=" amt-active");var n=a.querySelector(".amt-rating-under");n.style.width="100%"}else if(Number(t.toFixed(1))>=e-1&&Number(t.toFixed(1))<e&&t%1!==0){n.className+=" amt-active";var i=Number((t%1).toFixed(1));n.style.width=100*i+"%"}else a.style.color=this._defaultOptions.backgroundColor,a.classList.remove("amt-active"),n.style.width="0%"}},t.value=function(t){var e=document.querySelector(t);if(void 0===e||null===e)throw new Error("container do not exist");var a=e.querySelector(".amt-selected"),n=a.querySelector(".amt-rating-under"),i=Number(a.getAttribute("data-rating")),s=i-1+Number((.01*parseInt(n.style.width,10)).toFixed(1));return s},t}();